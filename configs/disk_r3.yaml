# Configuration for 3D U-Net Interactive with Disk Prompt Encoder
# Experiment: Binary spheres with radius=3 (RITM-style)

experiment:
  name: "unet3d_disk_r3"
  seed: 42
  output_dir: "./outputs"

data:
  dataset: "lits"
  data_root: "~/LiTS/Training-Batch-1"
  patch_size: [96, 96, 96]
  batch_size: 2
  num_workers: 4
  num_classes: 3

  encoder:
    type: "disk"
    radius: 3

  simulator:
    n_points_range: [1, 5]
    positive_ratio: 0.7
    error_simulation: true
    noise_std: 2.0
    sampling_strategy: "mixed"

model:
  type: "unet3d_interactive"
  in_channels: 1
  prompt_channels: 2
  out_channels: 3
  base_filters: 32
  depth: 4

training:
  max_epochs: 300
  learning_rate: 0.001
  weight_decay: 0.0001
  optimizer: "adam"
  scheduler: "cosine"
  warmup_epochs: 10
  loss:
    dice_weight: 0.5
    ce_weight: 0.5
  val_interval: 5
  save_top_k: 3
  prompt_dropout: 0.1

hardware:
  gpus: 1
  precision: 16

logging:
  log_every_n_steps: 50
  save_predictions: true
  num_prediction_samples: 5